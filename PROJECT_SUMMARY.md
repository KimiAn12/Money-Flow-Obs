# Money Flow Observatory - Project Summary

## Overview

Money Flow Observatory is a financial data visualization application that displays real-time capital flow metrics across global markets and asset classes. The project uses a **local backend architecture** where a Python script runs daily to fetch data from financial APIs, processes it, and saves it as static JSON files that are served by the frontend.

## Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Local Computer (Backend)                  â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Daily Script (5 PM) - scripts/update_data.py       â”‚  â”‚
â”‚  â”‚  â€¢ Fetches from Alpha Vantage API                    â”‚  â”‚
â”‚  â”‚  â€¢ Fetches from FRED API                             â”‚  â”‚
â”‚  â”‚  â€¢ Processes and transforms data                     â”‚  â”‚
â”‚  â”‚  â€¢ Saves JSON files to frontend/public/data/         â”‚  â”‚
â”‚  â”‚  â€¢ Commits and pushes to GitHub                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ Git Push
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GitHub Repository                         â”‚
â”‚                                                              â”‚
â”‚  frontend/public/data/                                      â”‚
â”‚  â”œâ”€â”€ global-flow.json      (Updated daily)                  â”‚
â”‚  â””â”€â”€ industry-flow.json    (Updated daily)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ Auto-deploy
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Vercel (Frontend)                         â”‚
â”‚                                                              â”‚
â”‚  React App                                                   â”‚
â”‚  â€¢ Reads from /data/global-flow.json                        â”‚
â”‚  â€¢ Reads from /data/industry-flow.json                      â”‚
â”‚  â€¢ No backend API calls needed                              â”‚
â”‚  â€¢ Serves static files via CDN                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Project Structure

```
MoneyFlowProject/
â”œâ”€â”€ frontend/                    # React frontend application
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â””â”€â”€ data/               # JSON data files (generated by script)
â”‚   â”‚       â”œâ”€â”€ global-flow.json
â”‚   â”‚       â””â”€â”€ industry-flow.json
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ GlobalMarkets.tsx    # Global market flow visualization
â”‚   â”‚   â”‚   â”œâ”€â”€ IndustryFlow.tsx     # Industry flow visualization
â”‚   â”‚   â”‚   â”œâ”€â”€ Hero.tsx             # Landing page
â”‚   â”‚   â”‚   â””â”€â”€ Index.tsx            # Main page
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ GlobalFlowMap.tsx    # Global flow map component
â”‚   â”‚   â”‚   â”œâ”€â”€ NetworkGraph.tsx     # Network graph component
â”‚   â”‚   â”‚   â””â”€â”€ ...                  # Other UI components
â”‚   â”‚   â”œâ”€â”€ data/                    # Fallback data (src/data/)
â”‚   â”‚   â”‚   â”œâ”€â”€ global-flow.json
â”‚   â”‚   â”‚   â””â”€â”€ industry-flow.json
â”‚   â”‚   â””â”€â”€ types/                   # TypeScript type definitions
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ backend/                     # FastAPI backend (optional, not used in production)
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ main.py             # FastAPI application
â”‚   â”‚   â”œâ”€â”€ api/                # API endpoints
â”‚   â”‚   â”œâ”€â”€ core/               # Core business logic
â”‚   â”‚   â””â”€â”€ models/             # Data models
â”‚   â””â”€â”€ requirements.txt
â”‚
â”œâ”€â”€ scripts/                     # Data update scripts
â”‚   â”œâ”€â”€ update_data.py          # Main data update script
â”‚   â”œâ”€â”€ requirements.txt        # Python dependencies
â”‚   â””â”€â”€ README.md               # Script documentation
â”‚
â””â”€â”€ logs/                       # Log files (gitignored)
    â””â”€â”€ update_data.log         # Script execution logs
```

## How It Works

### 1. Data Collection (Daily at 5 PM)

The `scripts/update_data.py` script runs daily on your local computer:

1. **Fetches Data from APIs**:
   - **Alpha Vantage API**: Stock prices, crypto prices
   - **FRED API**: Economic indicators, bond yields, currency exchange rates

2. **Processes Data**:
   - Transforms raw API data into frontend-compatible format
   - Calculates metrics (correlations, flow intensity, etc.)
   - Generates mock data as fallback if APIs fail

3. **Saves JSON Files**:
   - `frontend/public/data/global-flow.json` - Global market flow data
   - `frontend/public/data/industry-flow.json` - Industry flow data

4. **Commits to GitHub**:
   - Only commits if data has changed
   - Pushes changes to GitHub repository
   - Vercel automatically deploys updated files

### 2. Frontend (Vercel)

The React frontend application:

1. **Reads Static Files**:
   - Fetches data from `/data/global-flow.json`
   - Fetches data from `/data/industry-flow.json`
   - No backend API calls needed

2. **Displays Visualizations**:
   - **Global Markets**: Shows capital flows between regions (USA, China, Europe, Japan, India)
   - **Industry Flow**: Shows capital flows between asset classes (Stocks, Bonds, Commodities, Crypto, Cash)

3. **Features**:
   - Interactive maps and graphs
   - Real-time data visualization
   - Time range selection (1D, 1W, 1M, 3M, 1Y)
   - Asset type filtering (Equities, Bonds, Currency)

## Frontend-Backend Connection

### Current Architecture (Static Files)

**Frontend â†’ Static Files (No Backend)**

```
Frontend (React)
    â”‚
    â”œâ”€â†’ /data/global-flow.json (Static file)
    â”‚   â””â”€â†’ Served by Vercel CDN
    â”‚
    â””â”€â†’ /data/industry-flow.json (Static file)
        â””â”€â†’ Served by Vercel CDN
```

**Advantages**:
- âœ… No backend server needed
- âœ… Fast loading (CDN cached)
- âœ… No server downtime
- âœ… Cost effective (no hosting costs)
- âœ… Simple architecture

### Optional: Backend API (Not Used in Production)

The backend (`backend/`) is available for local development but **not used in production**:

```
Frontend (React)
    â”‚
    â””â”€â†’ Backend API (FastAPI)
        â”œâ”€â†’ /api/global-flow
        â””â”€â†’ /api/industry-flow
```

**When to use**:
- Local development
- Testing with live API data
- Development purposes only

## Data Flow

### Daily Update Flow

```
1. Local Computer (5 PM daily)
   â”‚
   â”œâ”€â†’ Script runs: scripts/update_data.py
   â”‚
   â”œâ”€â†’ Fetches from APIs:
   â”‚   â”œâ”€â†’ Alpha Vantage API
   â”‚   â””â”€â†’ FRED API
   â”‚
   â”œâ”€â†’ Processes data:
   â”‚   â”œâ”€â†’ Transforms to JSON
   â”‚   â”œâ”€â†’ Calculates metrics
   â”‚   â””â”€â†’ Generates visualizations data
   â”‚
   â”œâ”€â†’ Saves files:
   â”‚   â”œâ”€â†’ frontend/public/data/global-flow.json
   â”‚   â””â”€â†’ frontend/public/data/industry-flow.json
   â”‚
   â”œâ”€â†’ Commits to Git:
   â”‚   â”œâ”€â†’ git add frontend/public/data/*.json
   â”‚   â”œâ”€â†’ git commit -m "Update data YYYY-MM-DD"
   â”‚   â””â”€â†’ git push
   â”‚
   â””â”€â†’ GitHub â†’ Vercel (Auto-deploy)
       â””â”€â†’ Frontend serves updated files
```

### Frontend Data Flow

```
1. User visits website
   â”‚
   â”œâ”€â†’ React app loads
   â”‚
   â”œâ”€â†’ Fetches data:
   â”‚   â”œâ”€â†’ fetch("/data/global-flow.json")
   â”‚   â””â”€â†’ fetch("/data/industry-flow.json")
   â”‚
   â”œâ”€â†’ Processes data:
   â”‚   â”œâ”€â†’ Parses JSON
   â”‚   â”œâ”€â†’ Updates state
   â”‚   â””â”€â†’ Renders visualizations
   â”‚
   â””â”€â†’ User sees updated data
```

## Key Components

### Frontend Components

1. **GlobalMarkets.tsx**
   - Displays global market flow visualization
   - Shows capital flows between regions
   - Filters by asset type (Equities, Bonds, Currency)

2. **IndustryFlow.tsx**
   - Displays industry flow visualization
   - Shows capital flows between asset classes
   - Network graph visualization

3. **GlobalFlowMap.tsx**
   - Interactive map component
   - Displays regions and flows
   - Geographic visualization

4. **NetworkGraph.tsx**
   - Network graph component
   - Displays nodes and edges
   - Interactive visualization

### Backend Components (Optional)

1. **update_data.py**
   - Main data update script
   - Fetches from APIs
   - Processes and saves data

2. **FastAPI Backend** (Not used in production)
   - API endpoints for data
   - Data processing logic
   - Caching and persistence

## Setup and Deployment

### Prerequisites

1. **Python 3.10+** (for data update script)
2. **Node.js 18+** (for frontend)
3. **Git** (for version control)
4. **API Keys**:
   - Alpha Vantage API key
   - FRED API key

### Setup Steps

1. **Install Dependencies**:
   ```bash
   # Frontend
   cd frontend
   npm install
   
   # Scripts
   cd scripts
   pip install -r requirements.txt
   ```

2. **Set Environment Variables**:
   ```bash
   export ALPHA_VANTAGE_API_KEY="your-key"
   export FRED_API_KEY="your-key"
   ```

3. **Run Data Update Script**:
   ```bash
   python scripts/update_data.py
   ```

4. **Schedule Daily Execution**:
   - Linux/macOS: Use cron
   - Windows: Use Task Scheduler

5. **Deploy Frontend**:
   - Push to GitHub
   - Deploy to Vercel
   - Vercel serves static files

### Deployment

1. **Frontend (Vercel)**:
   - Connect GitHub repository
   - Set build command: `npm run build`
   - Set output directory: `dist`
   - Deploy automatically on push

2. **Data Updates**:
   - Script runs daily on local computer
   - Commits and pushes to GitHub
   - Vercel auto-deploys updated files

## Data Sources

### Alpha Vantage API
- **Stock Prices**: SPY, TLT, GLD
- **Crypto Prices**: BTC
- **Rate Limit**: 5 calls per minute (free tier)

### FRED API
- **Economic Indicators**: SP500, DGS10, DFF
- **Currency Rates**: DEXUSEU, DEXCHUS, DEXJPUS, DEXINUS
- **Rate Limit**: 120 calls per minute (free tier)

### Mock Data
- Generated when APIs fail
- Based on historical patterns
- Ensures data availability

## Features

### Global Markets
- **Regions**: USA, China, Europe, Japan, India
- **Metrics**: Stock indices, bond yields, currency strength
- **Flows**: Capital flows between regions
- **Filters**: Asset type (Equities, Bonds, Currency)

### Industry Flow
- **Asset Classes**: Stocks, Bonds, Commodities, Crypto, Cash
- **Metrics**: Market cap, net flow percentage, flow intensity
- **Correlations**: Asset class correlations
- **Visualization**: Network graph

## Issues and Fixes

### âœ… FIXED: Issue 1 - Frontend Still Uses API
**Problem**: Frontend pages (`GlobalMarkets.tsx`, `IndustryFlow.tsx`) were trying to fetch from backend API.

**Fix Applied**: 
- Updated both files to read from static files in `/data/global-flow.json` and `/data/industry-flow.json`
- Removed API calls, now uses `fetch("/data/global-flow.json")` instead
- Kept fallback to `src/data/` files if static files are not available

### âœ… FIXED: Issue 2 - Data Directory Missing
**Problem**: `frontend/public/data/` directory didn't exist.

**Fix Applied**: 
- Created `frontend/public/data/` directory
- Copied initial data files from `src/data/` to `public/data/`
- Script will update these files when run

### âœ… FIXED: Issue 3 - Initial Data Files
**Problem**: No initial data files in `public/data/`.

**Fix Applied**: 
- Copied `global-flow.json` and `industry-flow.json` to `public/data/`
- Frontend now has data to display immediately
- Script will update these files daily

## Best Practices

1. **Data Updates**: Run script daily at 5 PM
2. **Git Commits**: Only commit if data changed
3. **Error Handling**: Handle API failures gracefully
4. **Logging**: Log all operations for debugging
5. **Testing**: Test script manually before scheduling

## Troubleshooting

### Script Issues
- Check Python version: `python --version`
- Install dependencies: `pip install -r scripts/requirements.txt`
- Check environment variables
- Review logs: `logs/update_data.log`

### Frontend Issues
- Check if data files exist: `frontend/public/data/*.json`
- Verify file paths are correct
- Check browser console for errors
- Verify Vercel deployment

### Git Issues
- Verify Git is installed
- Check Git credentials
- Verify repository remote
- Check Git status

## Summary

**Money Flow Observatory** uses a **local backend architecture** where:
- âœ… **Data Collection**: Python script runs daily to fetch and process data
- âœ… **Data Storage**: JSON files stored in `frontend/public/data/`
- âœ… **Data Serving**: Vercel serves static files via CDN
- âœ… **Frontend**: React app reads from static files (no backend API)
- âœ… **Automation**: Daily updates, auto-commit, auto-deploy

**Key Benefits**:
- No backend server needed
- Fast loading (CDN cached)
- Cost effective (no hosting costs)
- Simple architecture
- Reliable (no server downtime)

## Next Steps

1. âœ… Fix frontend to read from static files
2. âœ… Create data directory structure
3. âœ… Run script to generate initial data
4. âœ… Schedule daily execution
5. âœ… Deploy to Vercel
6. âœ… Monitor and maintain

## Launch Status

### âœ… Completed
- [x] Frontend updated to read from static files
- [x] Data directory created
- [x] Initial data files copied to public/data/
- [x] Frontend pages updated
- [x] Git ignore configuration verified
- [x] Script creates directory correctly

### âš ï¸ Action Required Before Launch
- [ ] Set environment variables (ALPHA_VANTAGE_API_KEY, FRED_API_KEY)
- [ ] Run script to generate updated data: `python scripts/update_data.py`
- [ ] Schedule script to run daily at 5 PM
- [ ] Test frontend locally: `npm run dev`
- [ ] Deploy to Vercel
- [ ] Verify data updates daily

### ğŸ“ Notes
- Frontend will work with initial data files even if script hasn't run yet
- Script should be run before launch to ensure data is up-to-date
- Environment variables are required for real API data (script uses mock data if not set)

---

**Project Status**: âœ… Ready for launch (after setting environment variables and running script)
**Last Updated**: 2025-01-15
**Version**: 1.0.0
**Issues Fixed**: 3/3 critical issues fixed

